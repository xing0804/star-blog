---
title: HTTP 协议
date: 2021-12-1
sidebar: 'auto'
tags:
 - http
---

# HTTP协议

## HTTP请求信息和响应信息的格式

### 请求

* 请求行

  * 请求方法
    * 请求方式：GET POST PUT DELETE OPTIONS TRACE HEAD
    * TRACE:是你用了代理上网，比如用代理访问了news.163.com ,你想看看代理有没有修改你的HTTP请求，可以使用TRACE来测试一下，163.com的服务器就会把最后收到的请求返回给你
    * OPTIONS：返回服务器可用的请求方法
  * 请求路径
    * 请求的资源eg：/0606/01.php
  * 所用的协议
    * eg：HTTP/1.1

* 请求头信息

  * post请求的头信息里卖弄，要标明主体的长度
  * post比get多了主体信息
  * post需要添加 Content-length：30；Content-type:application/x-www/form-urlencoded

* 请求主体信息 （可以没有）

* > 头信息和主题信息直接得有个空格

### 响应

* 响应行
  * 版本协议
  * 状态码
    * 1xx  信息  接收到请求继续处理
    * 2xx  成功  操作成功地收到，理解和接受
      * 200-服务器成功返回网址
    * 3xx  重定向  未来完成请求，必须采取进一步措施
      * 301/2-永久/临时重定向
      * 304 Not Modified--未修改        内容从缓存读取
      * **307  如果想要重定向保持原有的请求数据，使用307**
    * 4xx  客户端错误  请求的语法有错误或不能完全被满足
      * 404--请求的网页不存在
    * 5xx  服务器端错误  服务器无法完成明显有效的请求
      * 503--服务器暂时不可用
      * 500--服务器内部错误
  * 状态文字
* 响应头信息
  * 用key：value的形式
* 响应主体



## 问答

* 问：浏览器可以发送http协议，那么http协议一定要浏览器发送吗？
* 答：**不是**，只要满足http协议，什么工具都可以发送



## referer防盗链

* 存在于头信息里面
* Referer：代表网页的来源，即上一页的地址





![image-20211129154753364](/image-20211129154753364.png)

该图错误：TCP/IP有四层   把数据链路层和物理层合并为网络接口层





超文本传输协议



## HTTP头信息

> kay: value

### 注意事项

* 字段名不区分大小写，字段名不允许出现空格，可以使用 ‘-’ 连接，不能使用‘_’（因为有的服务器不会解析带下滑线的头字段），格式必须key:空格value，key与：之间不能有空格
* 字段的顺序没有意义
* 字段原则上不能重复，除非这个字段本身的语义允许，eg ：Set-Cookie

### 常用头字段

* request：Host，Referer
* response：Server
* 通用：Content-type，Connection

## 请求过程

![image-20211129161157899](/image-20211129161157899.png)

## TCP协议

> TCP:面向连接的，可靠的，基于字节流的传输层通信协议
>
> TCP和UDP都工作在传输层，在程序之间传输数据

### 特点

* 基于**连接的**:数据传输之前需要建立连接
* **全双工**的:双向传输
* **字节流**:不限制数据大小，打包成报文段，保证有序接收，重复报文自动丢弃
* 流量缓冲:解决双方处理能力的不匹配
* 可靠的传输服务:保证可达，丢包时通过重发机制实现可靠性
* 拥塞控制:防止网络出现恶性拥塞

### 三次握手

> 建立连接的过程，因为这个过程中发送了三个包，SYN，SYN-ACK，ACK

* 客户端向服务器端发起连接的时候，会先发一包连接请求数据（SYN包），过去询问一下，能否与你建立来连接
* if agree 回复一个SYN-ACK包
* 客户端接受到之后回复一包ACK包
* 建立连接

> 如果黑客利用这个一直发送SYN包给服务器端而不进行下一步操作，服务器端就会崩溃，这就是**DDOS攻击**

![image-20211129171154786](/image-20211129171154786.png)

![image-20211201110556238](/image-20211201110556238.png)

问：为什么是三次而不是两次

答：为了解决网络信道不可靠的问题 

![image-20211129172221884](/image-20211129172221884.png)

### 四次挥手

处于连接状态的客户端和服务端，都可以关闭连接，用四次挥手来进行关闭

if 是客户端主动发起关闭请求

* 客户端发送一个**FIN**包，自己进入**终止等待1状态**    （第一次挥手）
* 服务器端接收后发送给客户端一个**ACK**包，自己进入**关闭等待状态**，客户端进入**终止等待2状态**   （第二次挥手）此时服务器端还可以发送数据，客户端还可以接收数据
* 服务器端发送完数据之后会发送一个**FIN**包，服务器进入**最终确认状态**（第三次挥手）
* 客户端收到FIN包之后回复**ACK**包，进入**超时等待**状态，经过超时时间之后关闭连接，服务器收到ACK包之后立即关闭连接   （第四次挥手）

![image-20211201111705647](/image-20211201111705647.png)

![image-20211201111635270](/image-20211201111635270.png)

### TCP和UDP的区别

* tcp  稳定可靠
  * 传输文件、发送邮件、浏览网页

* udp  速度快  性能损耗少  资源占比少  稳定性弱 
  * 可以适用于实时性要求改但是对少量丢包没有要求的
  * 域名查询、语音通话、视频直播 
  * 隧道网络（vpn、sdn中用到的VXLAN）

> 学习链接：https://www.bilibili.com/video/BV1js411g7Fw
